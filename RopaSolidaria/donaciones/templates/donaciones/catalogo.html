{% extends 'base.html' %}
{% block content %}

<div class="row mb-5 align-items-center">
    <div class="col-md-6">
        <h2><i class="bi bi-search text-primary"></i> Explorar Ropa</h2>
    </div>
    <div class="col-md-6 text-md-end">
        <span class="me-2 text-muted small"><i class="bi bi-filter"></i> Filtrar por Talla: </span>
        <div class="btn-group shadow-sm" role="group">
            <a href="{% url 'catalogo' %}" class="btn btn-outline-secondary {% if not talla_activa %}active{% endif %}">Todas</a>
            {% for t in tallas %}
                <a href="?talla={{ t }}" class="btn btn-outline-primary {% if talla_activa == t %}active{% endif %}">
                    {{ t }}
                </a>
            {% endfor %}
        </div>
    </div>
</div>

{% if prendas %}
    <div class="row">
        {% for prenda in prendas %}
        <div class="col-md-4 mb-4">

			<div class="card h-100 shadow-sm">
				<div id="carouselPrenda{{ prenda.id }}" class="carousel slide" data-bs-ride="carousel">
					<div class="carousel-inner">
						{% if prenda.foto1 %}
						<div class="carousel-item active">
							<img src="{{ prenda.foto1.url }}" class="d-block w-100" style="height: 200px; object-fit: cover;" alt="Foto 1">
						</div>
						{% endif %}
						{% if prenda.foto2 %}
						<div class="carousel-item">
							<img src="{{ prenda.foto2.url }}" class="d-block w-100" style="height: 200px; object-fit: cover;" alt="Foto 2">
						</div>
						{% endif %}
						{% if prenda.foto3 %}
						<div class="carousel-item">
							<img src="{{ prenda.foto3.url }}" class="d-block w-100" style="height: 200px; object-fit: cover;" alt="Foto 3">
						</div>
						{% endif %}
					</div>
					{% if prenda.foto2 or prenda.foto3 %}
					<button class="carousel-control-prev" type="button" data-bs-target="#carouselPrenda{{ prenda.id }}" data-bs-slide="prev">
						<span class="carousel-control-prev-icon" aria-hidden="true"></span>
					</button>
					<button class="carousel-control-next" type="button" data-bs-target="#carouselPrenda{{ prenda.id }}" data-bs-slide="next">
						<span class="carousel-control-next-icon" aria-hidden="true"></span>
					</button>
					{% endif %}
				</div>
				<div class="card-body">
					<h5 class="card-title">üëï {{ prenda.get_tipo_display }}</h5>
					<p class="card-text small text-muted">Talla üìè: {{ prenda.talla }} | Centro: {{ prenda.centro.nombre }}</p>
				</div>
                <div class="card-footer bg-white border-0 pb-3">
                    <a href="{% url 'solicitar' prenda.id %}" class="btn btn-primary w-100 rounded-pill">
                        Solicitar (-10 pts)
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
{% else %}
    <div class="text-center py-5">
        <i class="bi bi-emoji-frown display-1 text-muted"></i>
        <h4 class="mt-3">No hay prendas disponibles con estos filtros.</h4>
        <a href="{% url 'catalogo' %}" class="btn btn-link">Ver todo el cat√°logo</a>
    </div>
{% endif %}

{% endblock %}